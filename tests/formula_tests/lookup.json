{
  "name": "lookup",
  "generated": "2026-01-21T12:26:15.793540",
  "generator": "LibreOffice",
  "context_data": {},
  "tests": [
    {
      "formula": "=VLOOKUP(2,{1,\"a\";2,\"b\";3,\"c\"},2,FALSE)",
      "result": "b",
      "result_type": "str",
      "description": "vlookup exact"
    },
    {
      "formula": "=HLOOKUP(2,{1,2,3;\"a\",\"b\",\"c\"},2,FALSE)",
      "result": "b",
      "result_type": "str",
      "description": "hlookup exact"
    },
    {
      "formula": "=INDEX({1,2,3;4,5,6;7,8,9},2,3)",
      "result": 6,
      "result_type": "int",
      "description": "index 2d"
    },
    {
      "formula": "=MATCH(3,{1,2,3,4,5},0)",
      "result": 3,
      "result_type": "int",
      "description": "match exact"
    },
    {
      "formula": "=MATCH(3.5,{1,2,3,4,5},1)",
      "result": 3,
      "result_type": "int",
      "description": "match approx"
    },
    {
      "formula": "=CHOOSE(2,\"a\",\"b\",\"c\",\"d\")",
      "result": "b",
      "result_type": "str",
      "description": "choose"
    },
    {
      "formula": "=ROW(A5)",
      "result": 5,
      "result_type": "int",
      "description": "row function"
    },
    {
      "formula": "=COLUMN(E1)",
      "result": 5,
      "result_type": "int",
      "description": "column function"
    },
    {
      "formula": "=ROWS({1,2,3;4,5,6})",
      "result": 2,
      "result_type": "int",
      "description": "rows count"
    },
    {
      "formula": "=COLUMNS({1,2,3;4,5,6})",
      "result": 3,
      "result_type": "int",
      "description": "columns count"
    },
    {
      "formula": "=ADDRESS(1,1)",
      "result": "$A$1",
      "result_type": "str",
      "description": "address"
    },
    {
      "formula": "=ADDRESS(1,1,4)",
      "result": "A1",
      "result_type": "str",
      "description": "address relative"
    },
    {
      "formula": "=MATCH(1.1, {-1.1, 2.1, 3.1, 4.1}, 1)",
      "result": 1,
      "result_type": "int",
      "description": "MATCH approximate ascending, value below all"
    },
    {
      "formula": "=MATCH(3, {-1.1, 2.1, 3.1, 4.1})",
      "result": 2,
      "result_type": "int",
      "description": "MATCH default ascending, value between entries"
    },
    {
      "formula": "=MATCH(-1.1, {-1.1, 2.1, 3.1, 4.1})",
      "result": 1,
      "result_type": "int",
      "description": "MATCH ascending, exact first element"
    },
    {
      "formula": "=MATCH(1, {1, \"1\"}, 0)",
      "result": 1,
      "result_type": "int",
      "description": "MATCH exact finds number before string"
    },
    {
      "formula": "=MATCH(\"1\", {1, \"1\"}, 0)",
      "result": 2,
      "result_type": "int",
      "description": "MATCH exact finds string at position 2"
    },
    {
      "formula": "=INDEX({2,3;4,5}, 1, 1)",
      "result": 2,
      "result_type": "int",
      "description": "INDEX 2D array row 1 col 1"
    },
    {
      "formula": "=INDEX({2,3;4,5}, 2, 2)",
      "result": 5,
      "result_type": "int",
      "description": "INDEX 2D array row 2 col 2"
    },
    {
      "formula": "=INDEX({2,3;4,5}, 1, 2)",
      "result": 3,
      "result_type": "int",
      "description": "INDEX 2D array row 1 col 2"
    },
    {
      "formula": "=INDEX({2,3;4,5}, 2, 1)",
      "result": 4,
      "result_type": "int",
      "description": "INDEX 2D array row 2 col 1"
    },
    {
      "formula": "=INDEX({2,3,4}, 1, 1)",
      "result": 2,
      "result_type": "int",
      "description": "INDEX 1D array first element"
    },
    {
      "formula": "=INDEX({2,3,4}, 2)",
      "result": 3,
      "result_type": "int",
      "description": "INDEX 1D array second element"
    },
    {
      "formula": "=CHOOSE(1, \"Wide\", 115, \"world\", 8)",
      "result": "Wide",
      "result_type": "str",
      "description": "CHOOSE index 1"
    },
    {
      "formula": "=CHOOSE(3, \"Wide\", 115, \"world\", 8)",
      "result": "world",
      "result_type": "str",
      "description": "CHOOSE index 3"
    },
    {
      "formula": "=CHOOSE(2, 10, 20, 30)",
      "result": 20,
      "result_type": "int",
      "description": "CHOOSE numeric values"
    },
    {
      "formula": "=ROWS({1;2;3})",
      "result": 3,
      "result_type": "int",
      "description": "ROWS of 3x1 array"
    },
    {
      "formula": "=COLUMNS({1,2,3,4})",
      "result": 4,
      "result_type": "int",
      "description": "COLUMNS of 1x4 array"
    },
    {
      "formula": "=VLOOKUP(3, {1,\"a\";2,\"b\";3,\"c\"}, 2, FALSE)",
      "result": "c",
      "result_type": "str",
      "description": "VLOOKUP exact match last row"
    },
    {
      "formula": "=INDEX({1,2,3;4,5,6;7,8,9}, 3, 3)",
      "result": 9,
      "result_type": "int",
      "description": "INDEX 3x3 array bottom-right"
    },
    {
      "formula": "=MATCH(5, {1,2,3,4,5}, 0)",
      "result": 5,
      "result_type": "int",
      "description": "MATCH exact last element"
    },
    {
      "formula": "=MATCH(4.1, {4.1, 2.1, 3.1, 1.1}, -1)",
      "result": 1,
      "result_type": "int",
      "description": "MATCH descending first element"
    },
    {
      "formula": "=ADDRESS(5, 3, 1)",
      "result": "$C$5",
      "result_type": "str",
      "description": "ADDRESS absolute C5"
    },
    {
      "formula": "=LOOKUP(3, {1,2,3,4,5})",
      "result": 3,
      "result_type": "int",
      "description": "LOOKUP exact in sorted vector"
    },
    {
      "formula": "=LOOKUP(3.5, {1,2,3,4,5})",
      "result": 3,
      "result_type": "int",
      "description": "LOOKUP approximate in sorted vector"
    },
    {
      "formula": "=LOOKUP(2, {-1.1,2.1,3.1,4.1})",
      "result": -1.1,
      "result_type": "float",
      "description": "LOOKUP value below first match returns prior element"
    },
    {
      "formula": "=LOOKUP(3, {-1.1,2.1,3.1,4.1})",
      "result": 2.1,
      "result_type": "float",
      "description": "LOOKUP approximate returns largest <= target"
    }
  ]
}
